<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Seth Friend — Portfolio</title>
  <meta name="description" content="Portfolio of Seth Friend — robotics, controls, and embedded systems projects.">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="icon" href="assets/favicon.png">
</head>
<body>
  <header>
    <div class="brand">Seth Friend</div>
    <nav>
      <a href="#projects">Projects</a>
      <a href="#about">About</a>
      <a href="resume.pdf">Resume</a>
      <a href="mailto:seth@example.com">Contact</a>
    </nav>
  </header>

  <section class="hero">
    <div>
      <h1>Robotics & Embedded Systems Engineer</h1>
      <p>ECE @ UT Austin. I build robots and other cool projects.</p>
      <div class="cta">
        <a class="btn" href="#projects">See projects</a>
        <a class="btn secondary" href="https://github.com/" target="_blank" rel="noreferrer">GitHub</a>
      </div>
    </div>
  </section>

  <section id="about">
    <h2>About</h2>
    <p>
      I’m an Electrical and Computer Engineering Junior at UT Austin focused on robotics, controls, and embedded systems. My experience ranges from building custom robots and electronics to leading on-site deployments of robotic arms at Amazon facilities. I enjoy solving complex problems that combine mechanical design, embedded programming, and electrical systems—and I’m driven to create reliable, real-world robotics solutions.
    </p>
  </section>

  <section id="projects">
    <h2>Projects</h2>
    <div class="filters" id="filters"></div>
    <div class="grid" id="projectGrid" aria-live="polite"></div>
  </section>

  <footer>
    <div>© <span id="year"></span> Seth Friend · <a href="mailto:friend.seth03@gmail.com">Email</a></div>
  </footer>

  <script>
    const grid = document.getElementById('projectGrid');
    const filtersEl = document.getElementById('filters');
    const state = { tag:null, data:[] };

    // Detect GitHub Pages project site base ("/<repo>") or user site ("/")
    const repo = (location.hostname.endsWith('github.io') ? location.pathname.split('/')[1] : '').trim();
    const BASE = repo ? `/${repo}` : '';
    const CANDIDATES = [
      `${BASE}/data/projects.json`,
      `${BASE}/projects.json`,
      'data/projects.json',
      'projects.json'
    ];

    async function loadProjects(urls){
      const errs = [];
      for (const u of urls){
        try{
          const r = await fetch(u, { cache: 'no-store' });
          if (!r.ok) throw new Error(`${r.status} ${r.statusText}`);
          const j = await r.json();
          console.log('Loaded projects from:', u);
          return j;
        }catch(e){
          errs.push(`${u} → ${e.message}`);
          console.warn('Failed:', u, e.message);
        }
      }
      throw new Error(errs.join('\n'));
    }

    function render(){
      grid.innerHTML = '';
      const items = state.data.filter(p => !state.tag || (p.tags||[]).includes(state.tag));
      if (!items.length){
        grid.innerHTML = '<p style="color:#888">No projects found.</p>';
        return;
      }
      for (const p of items){
        const card = document.createElement('article');
        card.className = 'card';
        card.innerHTML = `
          ${p.image ? `<img class="responsive" src="${p.image}" alt="${p.title}">` : ''}
          <h3>${p.title}</h3>
          <div class="meta">${p.when} · ${p.role || ''}</div>
          <p>${p.summary}</p>
          <div class="chips">${(p.tags||[]).map(t=>`<span class="chip">${t}</span>`).join('')}</div>
          <div class="project-links" style="margin-top:10px;">
            ${p.page ? `<a href="${p.page}">Read more</a>` : ''}
            ${p.links?.github ? `<a href="${p.links.github}" target="_blank" rel="noreferrer">Code</a>` : ''}
            ${p.links?.demo ? `<a href="${p.links.demo}" target="_blank" rel="noreferrer">Demo</a>` : ''}
            ${p.links?.report ? `<a href="${p.links.report}" target="_blank" rel="noreferrer">Docs</a>` : ''}
          </div>`;
        grid.appendChild(card);
      }
    }

    function renderFilters(){
      const all = new Set();
      state.data.forEach(p => (p.tags||[]).forEach(t => all.add(t)));
      const tags = ['all', ...Array.from(all).sort()];
      filtersEl.innerHTML = tags.map(tag =>
        `<button class="filter${(state.tag===null && tag==='all') || state.tag===tag ? ' active' : ''}" data-t="${tag}">${tag}</button>`
      ).join('');
      filtersEl.onclick = (e) => {
        if (!e.target.matches('button')) return;
        const t = e.target.getAttribute('data-t');
        state.tag = (t === 'all') ? null : t;
        renderFilters(); render();
      };
    }

    loadProjects(CANDIDATES)
      .then(d => { state.data = d.projects || []; renderFilters(); render(); })
      .catch(err => {
        console.error('Could not load projects.json\n' + err.message);
        grid.innerHTML = '<div class="card" style="border-color:#e66"><h3>Could not load projects.json</h3><p>Check the file path and name.</p></div>';
      });

    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>
